<!--
Copyright (c) Microsoft. All rights reserved. Licensed under the MIT license.
See LICENSE in the project root for license information.
-->

<div class="ms-Grid-row">
   <!-- App navigation bar markup. -->
   <div class="ms-NavBar">
      <ul class="ms-NavBar-items">
         <li class="navbar-header">Office 365 Connect sample</li>
         <li class="ms-NavBar-item ms-NavBar-item--right" onclick="window.location.href='/disconnect'"><i class="ms-Icon ms-Icon--x"></i> Disconnect</li>
      </ul>
   </div>
   <!-- App main content markup. -->
   <form action="../../send_mail" method="post">
      <div class="ms-Grid-col ms-u-mdPush1 ms-u-md9 ms-u-lgPush1 ms-u-lg6">
         <div>
            <h2 class="ms-font-xxl ms-fontWeight-semibold">Hi, <%= @name %>!</h2>
            <p class="ms-font-xl">You're now connected to Office 365. Click the mail icon below to send a message from your account using the Microsoft Graph.</p>
            <div class="ms-TextField">
               <input class="ms-TextField-field" name="specified_email" value="<%= @email %>">
            </div>
            <button class="ms-Button">
            <span class="ms-Button-label">Send mail</span>
            </button>

            <!-- Result notification area -->
            <div>
            <%if @mail_sent %>
               <p class="ms-font-m ms-fontColor-green">Successfully sent an email to <%= @recipient %>!</p>
            <% elsif !@mail_sent && flash[:httpError] %>
               <p class="ms-font-m ms-fontColor-redDark">Something went wrong, couldn't send an email (<%= flash[:httpError] %>).</p>
            <% end %>
            </div>
            <div><%= link_to "Calendar", calendar_path %></div>
         </div>
      </div>
   </form>
</div>
